---

name: PR Comment Trigger

on:
  issue_comment:
    types:
      - created

jobs:
  comment-trigger:
    runs-on: ubuntu-latest
    env:
      USER_LIST: ${{ secrets.AUTH_LIST }}
      TRIGGER_STRING: 'I like strings'
    steps:
      - name: Like Pizza
        if: ${{ (github.event.comment.body == env.TRIGGER_STRING) && contains( env.USER_LIST, github.event.comment.user.login) }}
        uses: actions/github-script@v4
        with:
          script: |
            github.issues.createComment({
              issue_number: context.issue.number,
              owner: context.repo.owner,
              repo: context.repo.repo,
              body: 'Initiated Cori Compilation',
            });

  trigger-GitLab:
    needs: comment-trigger
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - name: output GitHub API
        run: .github/workflows/id_most_recent_comment_on_PR.sh ${{secrets.GITLAB_TRIGGER_TOKEN}}
